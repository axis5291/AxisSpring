<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="ko"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>RestTemplateServiceImpl.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Axis-Spring</a> &gt; <a href="index.source.html" class="el_package">Axis.Axis_Spring.service</a> &gt; <span class="el_source">RestTemplateServiceImpl.java</span></div><h1>RestTemplateServiceImpl.java</h1><pre class="source lang-java linenums">package Axis.Axis_Spring.service;

import java.net.URI;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.http.RequestEntity;
import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Service;
import org.springframework.web.client.RestTemplate;
import org.springframework.web.util.UriComponentsBuilder;

import Axis.Axis_Spring.data.dto.MemberDto;
import io.swagger.v3.oas.annotations.Operation;
import io.swagger.v3.oas.annotations.tags.Tag;
//ì´ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í• ë ¤ë©´ AxisServerBoxì˜ ë³„ë„ì˜ springAppë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬ë™ì‹œì¼œì•¼ í•œë‹¤. AxisServerBoxì—ì„œ ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µì„ í•˜ëŠ” ë³„ë„ì˜ ì„œë²„ì´ë‹¤.
// RestTemplateì€ Spring Frameworkì—ì„œ ì œê³µí•˜ëŠ” HTTP í†µì‹  í´ë¼ì´ì–¸íŠ¸,  ë‹¤ë¥¸ ì„œë²„(í˜¹ì€ ë‚´ ì„œë²„ì˜ ë‹¤ë¥¸ ì„œë¹„ìŠ¤)ì™€ í†µì‹ í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ë„êµ¬

@Service
<span class="fc" id="L20">public class RestTemplateServiceImpl implements RestTemplateService {</span>

<span class="fc" id="L22">    private final Logger LOGGER= LoggerFactory.getLogger(RestTemplateServiceImpl.class);</span>

    @Override
    public String getAxis(){
<span class="nc" id="L26">        System.out.println(&quot;getAxis() ë©”ì„œë“œ ì‹¤í–‰&quot;);</span>
<span class="nc" id="L27">        URI uri= UriComponentsBuilder   //*1.URIì„¤ì • UriComponentsBuilder : Springì—ì„œ URI(ì£¼ì†Œ)ë¥¼ ì•ˆì „í•˜ê³  ê¹”ë”í•˜ê²Œ ìƒì„±í•´ì£¼ëŠ” ë„êµ¬</span>
<span class="nc" id="L28">                .fromUriString(&quot;http://localhost:9090&quot;)</span>
<span class="nc" id="L29">                .path(&quot;/api/server/jong-ho&quot;)   //ë’¤ì— ë¶™ëŠ” ê²½ë¡œ</span>
<span class="nc" id="L30">                .encode()    //UTF-8ë¡œ ì¸ì½”ë”©</span>
<span class="nc" id="L31">                .build()</span>
<span class="nc" id="L32">                .toUri();  //ìœ„ì— build()ë¡œ ë°˜í™˜ì´ componentë¡œ ë¨ìœ¼ë¡œ urië¡œ ë³€ê²½,   build().toUri(): ìµœì¢… URI ê°ì²´ë¡œ ë³€í™˜</span>

<span class="nc" id="L34">        RestTemplate restTemplate=new RestTemplate();  //*2.í†µì‹ ì„ ìœ„í•œ RestTemplate ê°ì²´ ìƒì„±</span>
        
<span class="nc" id="L36">        ResponseEntity&lt;String&gt; responseEntity=restTemplate.getForEntity(uri, String.class);  </span>
       //3.* ì‹¤ì œë¡œ HTTP í†µì‹ ì„ ì‹¤í–‰í•´ì„œ, ì„œë²„ë¡œë¶€í„° ì‘ë‹µì„ ë°›ì•„ì˜¤ëŠ” í•µì‹¬ ì½”ë“œ, String.class-&gt;ResponseEntity&lt;String&gt;íƒ€ì…ì„ ë°ì¶”ê¸° ìœ„í•´ì„œ

<span class="nc" id="L39">            LOGGER.info(&quot;status code:{}&quot;, responseEntity.getStatusCode());</span>
<span class="nc" id="L40">            LOGGER.info(&quot;body: {}&quot;, responseEntity.getBody());</span>

<span class="nc" id="L42">            return responseEntity.getBody();</span>
    }

    @Override
    public String getName1(){
<span class="nc" id="L47">        System.out.println(&quot;getName1() ë©”ì„œë“œ ì‹¤í–‰&quot;);</span>
<span class="nc" id="L48">        URI uri= UriComponentsBuilder</span>
<span class="nc" id="L49">                .fromUriString(&quot;http://localhost:9090&quot;)</span>
<span class="nc" id="L50">                .path(&quot;/api/server/name1&quot;)  </span>
<span class="nc" id="L51">                .queryParam(&quot;name&quot;, &quot;Erlia&quot;)  //requestParameter-&gt;í‚¤ê°’ê³¼ valueê°’ì„ ë„£ëŠ”ë‹¤</span>
<span class="nc" id="L52">                .encode()   </span>
<span class="nc" id="L53">                .build()</span>
<span class="nc" id="L54">                .toUri();  </span>

<span class="nc" id="L56">        RestTemplate restTemplate=new RestTemplate();</span>
<span class="nc" id="L57">        ResponseEntity&lt;String&gt; responseEntity=restTemplate.getForEntity(uri, String.class);</span>
       
<span class="nc" id="L59">        LOGGER.info(&quot;status code:{}&quot;, responseEntity.getStatusCode());</span>
<span class="nc" id="L60">        LOGGER.info(&quot;body: {}&quot;, responseEntity.getBody());</span>

<span class="nc" id="L62">        return responseEntity.getBody();</span>
    }

    @Override
    public String getName2(){
<span class="nc" id="L67">        System.out.println(&quot;getName2() ë©”ì„œë“œ ì‹¤í–‰&quot;);</span>
<span class="nc" id="L68">        URI uri= UriComponentsBuilder</span>
<span class="nc" id="L69">                .fromUriString(&quot;http://localhost:9090&quot;)</span>
<span class="nc" id="L70">                .path(&quot;/api/server/path-variable/{name}&quot;)   //.expand(&quot;Erlia&quot;)ì˜ erliaë¥¼ ë„£ì–´ì£¼ê²Œ ëœë‹¤</span>
<span class="nc" id="L71">                .encode()  </span>
<span class="nc" id="L72">                .build()</span>
<span class="nc" id="L73">                .expand(&quot;Erlia2&quot;)  //ë³µìˆ˜ì˜ ê°’ì„ ë„£ì–´ì•¼ í•  ê²½ìš° , ì¶”ê°€í•˜ì—¬ êµ¬ë¶„</span>
<span class="nc" id="L74">                .toUri(); </span>

<span class="nc" id="L76">        RestTemplate restTemplate=new RestTemplate();</span>
<span class="nc" id="L77">        ResponseEntity&lt;String&gt; responseEntity=restTemplate.getForEntity(uri, String.class);</span>
      
<span class="nc" id="L79">        LOGGER.info(&quot;status code:{}&quot;, responseEntity.getStatusCode());</span>
<span class="nc" id="L80">        LOGGER.info(&quot;body: {}&quot;, responseEntity.getBody());</span>

<span class="nc" id="L82">        return responseEntity.getBody();</span>
    }

   
    @Override
    public ResponseEntity&lt;MemberDto&gt; postDto() {   // [âœ”] ë‹¨ìˆœíˆ ìš”ì²­ ë³¸ë¬¸ë§Œ ì „ì†¡í•˜ëŠ” POST ì˜ˆì œ
<span class="nc" id="L88">        System.out.println(&quot;postDto() ë©”ì„œë“œ ì‹¤í–‰&quot;);</span>
    
<span class="nc" id="L90">        URI uri = UriComponentsBuilder</span>
<span class="nc" id="L91">                .fromUriString(&quot;http://localhost:9090&quot;)</span>
<span class="nc" id="L92">                .path(&quot;/api/server/member&quot;)</span>
<span class="nc" id="L93">                .queryParam(&quot;name&quot;, &quot;Erlia22&quot;)   // [â—] ì‹¤ì œ ì„œë²„ì—ì„œ ì´ íŒŒë¼ë¯¸í„°ë¥¼ RequestParamìœ¼ë¡œ ë°›ì„ ê²½ìš°ì—ë§Œ ì˜ë¯¸ ìˆìŒ</span>
<span class="nc" id="L94">                .queryParam(&quot;email&quot;, &quot;erlia22@navre.com&quot;)</span>
<span class="nc" id="L95">                .queryParam(&quot;group&quot;, &quot;Axis22&quot;)</span>
<span class="nc" id="L96">                .encode()</span>
<span class="nc" id="L97">                .build()</span>
<span class="nc" id="L98">                .toUri();</span>
    
<span class="nc" id="L100">        MemberDto memberDTO = new MemberDto();   // ìš”ì²­ ë³¸ë¬¸ì— ë‹´ê¸¸ DTO ìƒì„±</span>
<span class="nc" id="L101">        memberDTO.setName(&quot;erlia22&quot;);</span>
<span class="nc" id="L102">        memberDTO.setEmail(&quot;aaa22@ssa.com&quot;);</span>
<span class="nc" id="L103">        memberDTO.setGroup(&quot;Axis22&quot;);</span>
    
<span class="nc" id="L105">        RestTemplate restTemplate = new RestTemplate();</span>
        
        // [âœ”] postForEntity(): URI, ìš”ì²­ ë°”ë””, ì‘ë‹µ íƒ€ì…ì„ ë°›ì•„ POST ìš”ì²­ì„ ì „ì†¡
<span class="nc" id="L108">        ResponseEntity&lt;MemberDto&gt; responseEntity =</span>
<span class="nc" id="L109">                restTemplate.postForEntity(uri, memberDTO, MemberDto.class);</span>
    
<span class="nc" id="L111">        LOGGER.info(&quot;status code:{}&quot;, responseEntity.getStatusCode());</span>
<span class="nc" id="L112">        LOGGER.info(&quot;body: {}&quot;, responseEntity.getBody());</span>
    
<span class="nc" id="L114">        return responseEntity;</span>
    }
    
    @Override
    public ResponseEntity&lt;MemberDto&gt; addHeader() {   // [âœ”] ìš”ì²­ ë³¸ë¬¸ + ì»¤ìŠ¤í…€ í—¤ë”ê¹Œì§€ í¬í•¨í•˜ì—¬ ì „ì†¡í•˜ëŠ” POST ì˜ˆì œ
<span class="nc" id="L119">        System.out.println(&quot;addHeader() ë©”ì„œë“œ ì‹¤í–‰&quot;);</span>
    
<span class="nc" id="L121">        URI uri = UriComponentsBuilder</span>
<span class="nc" id="L122">                .fromUriString(&quot;http://localhost:9090&quot;)</span>
<span class="nc" id="L123">                .path(&quot;/api/server/add-header&quot;)</span>
<span class="nc" id="L124">                .encode()</span>
<span class="nc" id="L125">                .build()</span>
<span class="nc" id="L126">                .toUri();</span>
    
<span class="nc" id="L128">        MemberDto memberDTO = new MemberDto();</span>
<span class="nc" id="L129">        memberDTO.setName(&quot;erlia5291&quot;);</span>
<span class="nc" id="L130">        memberDTO.setEmail(&quot;aaa@ssa.com&quot;);</span>
<span class="nc" id="L131">        memberDTO.setGroup(&quot;Axis5291&quot;);</span>
    
        // [âœ”] RequestEntityë¥¼ ì‚¬ìš©í•˜ë©´ ë©”ì„œë“œ, URI, í—¤ë”, ë³¸ë¬¸ê¹Œì§€ ëª¨ë‘ ì„¤ì • ê°€ëŠ¥
<span class="nc" id="L134">        RequestEntity&lt;MemberDto&gt; requestEntity = RequestEntity</span>
<span class="nc" id="L135">                .post(uri)</span>
<span class="nc" id="L136">                .header(&quot;Axis-Header&quot;, &quot;Axis Springì—ì„œ ë³´ë‚¸ headerê°’ì…ë‹ˆë‹¤.&quot;)  // [âœ”] ì»¤ìŠ¤í…€ í—¤ë” ì„¤ì •</span>
<span class="nc" id="L137">                .body(memberDTO);</span>
    
<span class="nc" id="L139">        RestTemplate restTemplate = new RestTemplate();</span>
        
        // [âœ”] exchange(): RequestEntityë¥¼ ì‚¬ìš©í•´ ìš”ì²­ ì „ì†¡, ì‘ë‹µ íƒ€ì…ì€ MemberDto
<span class="nc" id="L142">        ResponseEntity&lt;MemberDto&gt; responseEntity = restTemplate.exchange(requestEntity, MemberDto.class);</span>
    
<span class="nc" id="L144">        LOGGER.info(&quot;status code:{}&quot;, responseEntity.getStatusCode());</span>
<span class="nc" id="L145">        LOGGER.info(&quot;body: {}&quot;, responseEntity.getBody());</span>
    
<span class="nc" id="L147">        return responseEntity;</span>
    }
    
}

// ğŸ” ì™œ postForEntity() ë§ê³  exchange() + RequestEntity?
// postForEntity()ëŠ” ê°„ë‹¨í•˜ì§€ë§Œ, í—¤ë”ë¥¼ ë”°ë¡œ ì„¤ì •í•˜ê±°ë‚˜ ìš”ì²­ ì˜µì…˜ì„ ì„¸ë°€í•˜ê²Œ ì œì–´í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤.
// exchange()ëŠ” RequestEntityë¥¼ ë°›ì•„ì„œ í—¤ë” í¬í•¨ ì „ì²´ ìš”ì²­ì„ ìœ ì—°í•˜ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ë©”ì„œë“œì…ë‹ˆë‹¤.


// restTemplate.postForEntity(uri, memberDTO, MemberDto.class);
// í—¤ë” ì„¤ì • ë¶ˆê°€, ê¸°ë³¸ Content-Typeë§Œ ê°€ëŠ¥
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>